import{_ as s,o as a,c as l,R as n}from"./chunks/framework.333b51ca.js";const D=JSON.parse('{"title":"PostgreSQL NOT NULL","description":"","frontmatter":{},"headers":[],"relativePath":"database/postgreSQL/databaseAndTable/NOT_NULL.md","filePath":"database/postgreSQL/databaseAndTable/NOT_NULL.md","lastUpdated":1690289709000}'),o={name:"database/postgreSQL/databaseAndTable/NOT_NULL.md"},p=n(`<h1 id="postgresql-not-null" tabindex="-1">PostgreSQL NOT NULL <a class="header-anchor" href="#postgresql-not-null" aria-label="Permalink to &quot;PostgreSQL NOT NULL&quot;">​</a></h1><p>PostgreSQL <code>NOT NULL</code> 约束用来限制列的值不能为空。</p><p>在 PostgreSQL 中，<code>NOT NULL</code> 是列上的约束，它用来约束列中的值不能为 <code>NULL</code> 值。</p><p>注意， <code>NULL</code> 不是空串，也不是 <code>0</code>，它表示什么都没有。您可以使用 <a href="/database/postgreSQL/base/IS_NULL.html"><code>IS NULL</code></a> 操作符判断一个值是否是 NULL。</p><h2 id="postgresql-not-null-语法" tabindex="-1">PostgreSQL <code>NOT NULL</code> 语法 <a class="header-anchor" href="#postgresql-not-null-语法" aria-label="Permalink to &quot;PostgreSQL \`NOT NULL\` 语法&quot;">​</a></h2><p>要定义一个 <code>NOT NULL</code> 的列，请使用以下方法。</p><h3 id="定义-not-null-列" tabindex="-1">定义 NOT NULL 列 <a class="header-anchor" href="#定义-not-null-列" aria-label="Permalink to &quot;定义 NOT NULL 列&quot;">​</a></h3><p>请使用以下语法定义一个 <code>NOT NULL</code> 列：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">table_name</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  ...</span></span>
<span class="line"><span style="color:#A6ACCD;">  column_name data_type </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;"> ...,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ...</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span></code></pre></div><h3 id="添加-not-null-约束" tabindex="-1">添加 NOT NULL 约束 <a class="header-anchor" href="#添加-not-null-约束" aria-label="Permalink to &quot;添加 NOT NULL 约束&quot;">​</a></h3><p>要向现有的列添加 <code>NOT NULL</code> 约束，请使用以下语法修改列的定义：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> table_name</span></span>
<span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> COLUMN column_name </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><p><code>column_name</code> 是要添加 <code>NOT NULL</code> 约束的列的名字。</p><h3 id="删除-not-null-约束" tabindex="-1">删除 NOT NULL 约束 <a class="header-anchor" href="#删除-not-null-约束" aria-label="Permalink to &quot;删除 NOT NULL 约束&quot;">​</a></h3><p>要删除列上的 <code>NOT NULL</code> 约束，请使用以下语法修改列的定义：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> table_name</span></span>
<span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> COLUMN column_name </span><span style="color:#F78C6C;">DROP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><p><code>column_name</code> 是要从中删除 <code>NOT NULL</code> 约束的列的名字。</p><h2 id="postgresql-not-null-实例" tabindex="-1">PostgreSQL NOT NULL 实例 <a class="header-anchor" href="#postgresql-not-null-实例" aria-label="Permalink to &quot;PostgreSQL NOT NULL 实例&quot;">​</a></h2><p>让我们通过一个例子了解 <code>NOT NULL</code> 的作用。请按照以下步骤进行操作：</p><ol><li><p>通过以下语句创建 <code>user_hobby</code> 表：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">DROP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">EXISTS</span><span style="color:#A6ACCD;"> user_hobby;</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">user_hobby</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  hobby_id </span><span style="color:#C792EA;">SERIAL</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  user_id </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  hobby </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">45</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span></code></pre></div><p>这里，<code>user_id</code> 和 <code>hobby</code> 列中不接受 <code>NULL</code> 值。</p></li><li><p>插入几行数据</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> user_hobby (user_id, hobby)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Football</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">), (</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Swimming</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span></code></pre></div><p>很显然能插入成功。</p></li><li><p>向 <code>hobby</code> 列中插入 <code>NULL</code> 值:</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> user_hobby (user_id, hobby)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">ERROR:  </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">value</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> column </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hobby</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> violates </span><span style="color:#F78C6C;">not</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">constraint</span></span>
<span class="line"><span style="color:#A6ACCD;">DETAIL:  Failing </span><span style="color:#F78C6C;">row</span><span style="color:#A6ACCD;"> contains (</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">).</span></span></code></pre></div><p>PostgreSQL 服务器会返回了上面的错误。因为 <code>hobby</code> 列不能为空。</p></li></ol><h2 id="将现有列修改为不能为空" tabindex="-1">将现有列修改为不能为空 <a class="header-anchor" href="#将现有列修改为不能为空" aria-label="Permalink to &quot;将现有列修改为不能为空&quot;">​</a></h2><p>如果你想将现有的一个允许 NULL 值的列修改为不允许 NULL 值，请先将该列中的 <code>NULL</code> 值修改为非 <code>NULL</code> 值，否则可能遇到错误。</p><p>假设，我们有下面的一个表：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">DROP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">EXISTS</span><span style="color:#A6ACCD;"> user_hobby;</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">user_hobby</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  hobby_id </span><span style="color:#C792EA;">SERIAL</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  user_id </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  hobby </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">45</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span></code></pre></div><p>这里，<code>hobby</code> 列中是可以有 <code>NULL</code> 值的。</p><p>现在我们插入几行测试数据：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> user_hobby (user_id, hobby)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Football</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">), (</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span></code></pre></div><p>现在我们看以下表中的数据：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> user_hobby;</span></span></code></pre></div><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">hobby_id | user_id |  hobby</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">----------+---------+----------</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> |       </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> | Football</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> |       </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> |</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">rows</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>运行如下语句为 <code>hobby</code> 列添加 <code>NOT NULL</code> 约束：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> user_hobby</span></span>
<span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> hobby </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ERROR:</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">column</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">hobby</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">contains</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">values</span></span></code></pre></div><p>PostgreSQL 会返回了上面的错误。这是因为其中一行的 <code>hobby</code> 列中的值为 <code>NULL</code>。</p><p>我们应该首先将 <code>hobby</code> 列中 NULL 值改为非 NULL 值：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> user_hobby</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> hobby </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">NOTHING</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> hobby </span><span style="color:#F78C6C;">IS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><p>然后我们再为 <code>hobby</code> 列添加 <code>NOT NULL</code> 约束：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> user_hobby</span></span>
<span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> hobby </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><p>现在已经成功的为 <code>hobby</code> 列添加了 <code>NOT NULL</code> 约束。</p><h2 id="结论" tabindex="-1">结论 <a class="header-anchor" href="#结论" aria-label="Permalink to &quot;结论&quot;">​</a></h2><p>在本文中，我们学习了在 PostgreSQL 中如何使用 <code>NOT NULL</code> 限制列的值不能为 <code>NULL</code>。</p>`,41),e=[p];function c(t,C,r,y,A,i){return a(),l("div",null,e)}const L=s(o,[["render",c]]);export{D as __pageData,L as default};
