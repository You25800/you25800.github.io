import{_ as s,o as a,c as n,R as l}from"./chunks/framework.333b51ca.js";const F=JSON.parse('{"title":"PostgreSQL IDENTITY COLUMN 标识列","description":"","frontmatter":{},"headers":[],"relativePath":"database/postgreSQL/databaseAndTable/标识列.md","filePath":"database/postgreSQL/databaseAndTable/标识列.md","lastUpdated":1690289709000}'),p={name:"database/postgreSQL/databaseAndTable/标识列.md"},o=l(`<h1 id="postgresql-identity-column-标识列" tabindex="-1">PostgreSQL IDENTITY COLUMN 标识列 <a class="header-anchor" href="#postgresql-identity-column-标识列" aria-label="Permalink to &quot;PostgreSQL IDENTITY COLUMN 标识列&quot;">​</a></h1><p>PostgreSQL 标识列用于定义一个可以自动生成唯一值的列。</p><p>在 PostgreSQL 中，标识列是一个特殊的<a href="./生成列.html">生成列</a>，该列的值能自动生成并且是唯一的。标识列是定义在列上的约束。</p><p>标识列和 <a href="./SERIAL自增列.html"><code>SERIAL</code></a> 类似，他们的内部都使用 <a href="./SEQUENCE序列生成器.html"><code>SEQUENCE</code></a> 实现。</p><p>不像<a href="./主键.html">主键</a>，一个表中允许存在多个标识列，并且标识列中允许存在重复的值。</p><h2 id="标识列的语法" tabindex="-1">标识列的语法 <a class="header-anchor" href="#标识列的语法" aria-label="Permalink to &quot;标识列的语法&quot;">​</a></h2><p>要创建标识列，请使用以下语法：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">col_name data_type</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">GENERATED</span><span style="color:#A6ACCD;"> { </span><span style="color:#F78C6C;">ALWAYS</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> } </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IDENTITY</span><span style="color:#A6ACCD;"> [ ( sequence_options ) ]</span></span></code></pre></div><p>解释说明：</p><ul><li>标识列的数据类型可以是：<code>SMALLINT</code>, <code>INT</code>，或 <code>BIGINT</code>。</li><li><code>GENERATED ALWAYS AS IDENTITY</code> 列的值不能被写入。 向此列中插入（或更新）值将会导致一个错误。有一个特殊情况，就在 <code>INSERT</code> 语句中使用 <code>OVERRIDING SYSTEM VALUE</code> 指令可以向此列插入值。</li><li><code>GENERATED BY DEFAULT AS IDENTITY</code> 列的值能被写入，包括插入和更新。</li><li><code>sequence_options</code> 指明了标识列内部使用的序列的选项。它是可选的，如果不指定，PostgreSQL 使用默认值产生一个序列。</li></ul><p>你可以在通过 <a href="./创建表.html"><code>CREATE TABLE</code></a> 语句创建表时定义标识列，或者通过 <a href="./修改表.html"><code>ALTER TABLE</code></a> 语句添加一个标识列。</p><h3 id="在创建表时定义标识列" tabindex="-1">在创建表时定义标识列 <a class="header-anchor" href="#在创建表时定义标识列" aria-label="Permalink to &quot;在创建表时定义标识列&quot;">​</a></h3><p>要在创建表时添加标识列，请使用如下语法：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">table_name</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  column_definition,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ...</span></span>
<span class="line"><span style="color:#A6ACCD;">  col_name data_type </span><span style="color:#F78C6C;">GENERATED</span><span style="color:#A6ACCD;"> { </span><span style="color:#F78C6C;">ALWAYS</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> } </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IDENTITY</span><span style="color:#A6ACCD;"> [ ( sequence_options ) ],</span></span>
<span class="line"><span style="color:#A6ACCD;">  ...</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span></code></pre></div><h3 id="添加标识列" tabindex="-1">添加标识列 <a class="header-anchor" href="#添加标识列" aria-label="Permalink to &quot;添加标识列&quot;">​</a></h3><p>要在创建表后添加一个标识列，请使用 <code>ALTER TABLE</code> 语句：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> table_name</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">ADD</span><span style="color:#A6ACCD;"> COLUMN col_name data_type</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">GENERATED</span><span style="color:#A6ACCD;"> { </span><span style="color:#F78C6C;">ALWAYS</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> } </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IDENTITY</span><span style="color:#A6ACCD;"> [ ( sequence_options ) ];</span></span></code></pre></div><h3 id="将一个列设置表标识列" tabindex="-1">将一个列设置表标识列 <a class="header-anchor" href="#将一个列设置表标识列" aria-label="Permalink to &quot;将一个列设置表标识列&quot;">​</a></h3><p>要将一个已有的列设置为标识列，请使用 <code>ALTER TABLE</code> 语句：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> table_name</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> COLUMN col_name</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">ADD</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">GENERATED</span><span style="color:#A6ACCD;"> { </span><span style="color:#F78C6C;">ALWAYS</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> } </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IDENTITY</span><span style="color:#A6ACCD;"> [ ( sequence_options ) ];</span></span></code></pre></div><p>或者</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> table_name</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> COLUMN col_name</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">GENERATED</span><span style="color:#A6ACCD;"> { </span><span style="color:#F78C6C;">ALWAYS</span><span style="color:#A6ACCD;"> | </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> };</span></span></code></pre></div><h3 id="取消一个标识列" tabindex="-1">取消一个标识列 <a class="header-anchor" href="#取消一个标识列" aria-label="Permalink to &quot;取消一个标识列&quot;">​</a></h3><p>要取消一个标识列，请使用 <code>ALTER TABLE</code> 语句：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> table_name</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> COLUMN col_name</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">DROP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IDENTITY</span><span style="color:#A6ACCD;"> [ IF EXISTS ];</span></span></code></pre></div><h2 id="postgresql-标识列实例" tabindex="-1">PostgreSQL 标识列实例 <a class="header-anchor" href="#postgresql-标识列实例" aria-label="Permalink to &quot;PostgreSQL 标识列实例&quot;">​</a></h2><p>下面有一些展示 PostgreSQL 标识列用法的实例。</p><h3 id="创建标识列实例" tabindex="-1">创建标识列实例 <a class="header-anchor" href="#创建标识列实例" aria-label="Permalink to &quot;创建标识列实例&quot;">​</a></h3><p>使用下面的语句创建一个表，其中 <code>id</code> 列是标识列：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">test_identity</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  id </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">GENERATED</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">ALWAYS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IDENTITY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  bash </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">45</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span></code></pre></div><p>您可以通过 <code>\\d</code> 命令查看 <code>test_identity</code> 中标识列的情况：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">\\d test_identity</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Table</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">public.test_identity</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Column</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">         </span><span style="color:#FFCB6B;">Type</span><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Collation</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Nullable</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">           </span><span style="color:#FFCB6B;">Default</span></span>
<span class="line"><span style="color:#FFCB6B;">--------+-----------------------+-----------+----------+------------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">id</span><span style="color:#A6ACCD;">     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">integer</span><span style="color:#A6ACCD;">               </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">generated</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">always</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">identity</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">character</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">varying</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">45</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span></span></code></pre></div><p>使用以下语句插入 2 行测试数据：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> test_identity (bash)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Apple</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">), (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Peach</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span></code></pre></div><p>使用以下语句查找 <code>test_identity</code> 表中的所有行：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> test_identity;</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">id</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">bash</span></span>
<span class="line"><span style="color:#FFCB6B;">----+-------</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Apple</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Peach</span></span>
<span class="line"><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rows</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>从输出可以看到， <code>id</code> 列中的自动生成的值是一个自增的序列。</p><h3 id="向标识列中插入值实例" tabindex="-1">向标识列中插入值实例 <a class="header-anchor" href="#向标识列中插入值实例" aria-label="Permalink to &quot;向标识列中插入值实例&quot;">​</a></h3><p>下面的语句尝试使用 <code>INSERT</code> 向标识列中插入一个值：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> test_identity (id, bash)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Banana</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">RETURNING </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">ERROR:</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">cannot</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">insert</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">into</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">column</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#FFCB6B;">DETAIL:</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">Column</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">is</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">an</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">identity</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">column</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">defined</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">GENERATED</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ALWAYS.</span></span>
<span class="line"><span style="color:#FFCB6B;">HINT:</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">Use</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">OVERRIDING</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">SYSTEM</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">VALUE</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">override.</span></span></code></pre></div><p>这里，由于 <code>id</code> 列带有 <code>GENERATED ALWAYS AS IDENTITY</code> 约束，因此不能直接插入值。按照 PostgreSQL 的提示，可以使用 <code>OVERRIDING SYSTEM VALUE</code> 强制插入，如下：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> test_identity (id, bash)</span></span>
<span class="line"><span style="color:#A6ACCD;">OVERRIDING </span><span style="color:#F78C6C;">SYSTEM</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">VALUE</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Banana</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">RETURNING </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">id</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">bash</span></span>
<span class="line"><span style="color:#FFCB6B;">----+--------</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Banana</span></span>
<span class="line"><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">row</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>同时，我们也可以看出，标识列是允许重复值的。</p><h3 id="多个标识列实例" tabindex="-1">多个标识列实例 <a class="header-anchor" href="#多个标识列实例" aria-label="Permalink to &quot;多个标识列实例&quot;">​</a></h3><p>一个表中可以存在多个标识列，下面的语句添加一个标识列 <code>id_2</code>，并且起始值为 10，每次自增 10：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> test_identity</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">ADD</span><span style="color:#A6ACCD;"> COLUMN id_2 </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">GENERATED</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">ALWAYS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IDENTITY</span></span>
<span class="line"><span style="color:#A6ACCD;">    (</span><span style="color:#F78C6C;">START</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WITH</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> INCREMENT </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">);</span></span></code></pre></div><p>让我们看一下表中的数据：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> test_identity;</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">id</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">id_2</span></span>
<span class="line"><span style="color:#FFCB6B;">----+--------+------</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Apple</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#FFCB6B;">10</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Peach</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#FFCB6B;">20</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Banana</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#FFCB6B;">30</span></span>
<span class="line"><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rows</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>您可以发现，添加一个标识列后，已有的行中的标识列中的值已经自动生成。</p><p>使用以下语句插入 2 行测试数据：</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> test_identity (bash)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Pear</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">), (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Cherry</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">RETURNING </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">;</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">id</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">bash</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">id_2</span></span>
<span class="line"><span style="color:#FFCB6B;">----+--------+-----</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Pear</span><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">40</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Cherry</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  </span><span style="color:#FFCB6B;">50</span></span>
<span class="line"><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">rows</span><span style="color:#89DDFF;">)</span></span></code></pre></div><h2 id="结论" tabindex="-1">结论 <a class="header-anchor" href="#结论" aria-label="Permalink to &quot;结论&quot;">​</a></h2><p>在本文中，我们学习了 PostgreSQL 标识列的用法。</p>`,59),e=[o];function t(c,C,r,A,y,D){return a(),n("div",null,e)}const d=s(p,[["render",t]]);export{F as __pageData,d as default};
