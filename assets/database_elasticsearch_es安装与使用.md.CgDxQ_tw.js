import{_ as p,B as h,c as k,o as r,b3 as a,G as e,j as i,w as n,a as t}from"./chunks/framework.CatkIGlB.js";const c="/assets/download.a0Ip9nKI.png",o="/assets/1.DJO2o_ZB.png",d="/assets/3.CN0N4tnZ.png",g="/assets/2.C98JccXn.png",y="/assets/4.B6jcwta6.png",m="/assets/image-20220927153941132.DANVYFbP.png",E="/assets/image-20220927154149016.fvcwiDDk.png",B="/assets/image-20220927154230580.N4JRDHHA.png",D="/assets/image-20220927154313380.CczPIu7G.png",C="/assets/image-20220927154437177.CfWqe2GM.png",u="/assets/image-20220927154528494.D0H6roJS.png",f="/assets/image-20220927154618352.CWIuKRoq.png",F="/assets/image-20220927162802262.Dl7N1UfI.png",b="/assets/image-20220927163303119.BxR-ucvG.png",A="/assets/image-20220927163357772.DyGS4r71.png",_="/assets/image-20220927163743685.CCxNfR4j.png",v="/assets/image-20220927163905182.BoPT1uEd.png",x="/assets/image-20220927163951266.ujyUzklK.png",w="/assets/image-20220927164758235.DKWzEnsq.png",T="/assets/image-20220927165222266.DnJ_bla-.png",R=JSON.parse('{"title":"Elasticsearch 安装 & 使用","description":"","frontmatter":{},"headers":[],"relativePath":"database/elasticsearch/es安装与使用.md","filePath":"database/elasticsearch/es安装与使用.md","lastUpdated":1688630446000}'),z={name:"database/elasticsearch/es安装与使用.md"},S={start:"9"};function P(J,s,V,q,I,N){const l=h("font");return r(),k("div",null,[s[6]||(s[6]=a('<h1 id="elasticsearch-安装-使用" tabindex="-1"><strong>Elasticsearch</strong> <strong>安装</strong> <strong>&amp;</strong> <strong>使用</strong> <a class="header-anchor" href="#elasticsearch-安装-使用" aria-label="Permalink to &quot;**Elasticsearch** **安装** **&amp;** **使用**&quot;">​</a></h1><p>本章是根据尚硅谷教学视频编写 <a href="https://www.bilibili.com/video/BV1hh411D7sb/?spm_id_from=333.337.search-card.all.click&amp;vd_source=c2c3977953334eb68fd28f89418ceaa6" target="_blank" rel="noreferrer">https://www.bilibili.com/video/BV1hh411D7sb/?spm_id_from=333.337.search-card.all.click&amp;vd_source=c2c3977953334eb68fd28f89418ceaa6</a></p><h2 id="下载软件" tabindex="-1"><strong>下载软件</strong> <a class="header-anchor" href="#下载软件" aria-label="Permalink to &quot;**下载软件**&quot;">​</a></h2><p>Elasticsearch 的官方地址：<a href="https://www.elastic.co/cn/" target="_blank" rel="noreferrer">https://www.elastic.co/cn/</a></p><p>Elasticsearch 最新的版本是 8.2.3（截止 2022.06.15），我们选择略早的 8.1.0 版本</p><p>下载地址：<a href="https://www.elastic.co/cn/downloads/past-releases#elasticsearch" target="_blank" rel="noreferrer">https://www.elastic.co/cn/downloads/past-releases#elasticsearch</a></p><img src="'+c+`" alt="image-elasticsearch-download" style="zoom:100%;"><p>可以根据情况自行选择不同操作系统的版本。</p><h2 id="安装软件" tabindex="-1">安装软件 <a class="header-anchor" href="#安装软件" aria-label="Permalink to &quot;安装软件&quot;">​</a></h2><p>针对新版ES软件的特性与应用，所以采用Linux集群配置</p><ol><li><p>集群规划</p><p>为了演示软件的使用，我们这里准备三台 linux 虚拟机，用于配置 Elasticsearch 集群。</p><p>启动集群后，每台虚拟机的进程如下：</p><table tabindex="0"><thead><tr><th>主机名</th><th>linux1</th><th>linux2</th><th>linux3</th></tr></thead><tbody><tr><td>进程名</td><td>Elasticsearch(es-node-1)</td><td>Elasticsearch(es-node-2)</td><td>Elasticsearch(es-node-3)</td></tr></tbody></table><p>Linux 系统环境配置请参考之前课程内容。这里我们给三台虚拟机搭建 ES 集群，集群</p><p>中-节点名称依次为 es-node-1，es-node-2，es-node-3</p></li><li><p>将压缩包 elasticsearch-8.1.0-linux-x86_64.tar.gz 上传到虚拟机中</p><p>解压缩文件到自定义路径，笔者解压路径为：/opt/module,解压后，软件路径为：</p><p>/opt/module/elasticsearch-8.1.0</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 切换目录</span></span>
<span class="line"><span style="--shiki-light:#6182B8;--shiki-dark:#82AAFF;">cd</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> software</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 解压缩</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">tar</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> -zxvf</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> elasticsearch-8.1.0-linux-x86_64.tar.gz</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> -C</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> /opt/module</span></span></code></pre></div><p>解压后的 Elasticsearch 的目录结构如下</p><img src="`+o+`" alt="image-20220927135705960" style="zoom:100%;"><table tabindex="0"><thead><tr><th>目录</th><th>含义</th></tr></thead><tbody><tr><td>bin</td><td>可执行脚本目录</td></tr><tr><td>config</td><td>配置目录</td></tr><tr><td>jdk</td><td>内置JDK目录</td></tr><tr><td>lib</td><td>类库</td></tr><tr><td>logs</td><td>日志目录</td></tr><tr><td>modules</td><td>模块目录</td></tr><tr><td>plugins</td><td>插件目录</td></tr></tbody></table></li><li><p>当前安装 ES 版本为 8.1.0，自带 JDK，所以当前 Linux 虚拟机节点无需配置 Java 环境</p></li><li><p>创建linux新用户es，数据文件，证书目录，并修改Elasticsearch文件拥有者</p><p><code>由于es不允许root用户操作，所以需要创建新用户</code></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 新增es用户</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">useradd</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> es</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 为es用户设置密码</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">passwd</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> es</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 创建数据文件目录</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">mkdir</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> /opt/module/elasticsearch-8.1.0/data</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 创建证书目录</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">mkdir</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> /opt/module/elasticsearch-8.1.0/config/certs</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 切换目录</span></span>
<span class="line"><span style="--shiki-light:#6182B8;--shiki-dark:#82AAFF;">cd</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> /opt/module/elasticsearch-8.1.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 修改文件拥有者</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">chown</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> -R</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> es:es</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> /opt/module/elasticsearch-8.1.0</span></span></code></pre></div></li><li><p>在第一台服务器节点es-node-1设置集群多节点通信密钥</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 切换用户</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">su</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> es</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 签发 ca 证书，过程中需按两次回车键</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">bin/elasticsearch-certutil</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> ca</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 用 ca 证书签发节点证书，过程中需按三次回车键</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">bin/elasticsearch-certutil</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> cert</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> --ca</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> elastic-stack-ca.p12</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 将生成的证书文件移动到 config/certs 目录中</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">mv</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> elastic-stack-ca.p12</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> elastic-certificates.p12</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> config/certs</span></span></code></pre></div></li><li><p>在第一台服务器节点es-node-1设置集群多节点HTTP证书</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 签发 Https 证书</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">bin/elasticsearch-certutil</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> http</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 以下是每次要求输入时，需要输入的内容</span></span></code></pre></div><img src="`+d+'" alt="image-20220927135705960" style="zoom:100%;"><img src="'+g+'" alt="image-20220927135705960" style="zoom:100%;"><p>指定证书路径</p><img src="'+y+'" alt="image-20220927135705960" style="zoom:100%;"><p>无需输入密码</p><img src="'+m+'" alt="image-20220927153941132" style="zoom:100%;"><p>设置证书失效时间</p><img src="'+E+'" alt="image-20220927154149016" style="zoom:100%;"><p>无需每个节点配置证书</p><img src="'+B+'" alt="image-20220927154230580" style="zoom:100%;"><p>输出连接到第一个节点的所有主机名</p><img src="'+D+'" alt="image-20220927154313380" style="zoom:100%;"><p>输出连接到第一个基点的所有主机 <strong>IP</strong> 地址</p><img src="'+C+'" alt="image-20220927154437177" style="zoom:100%;"><p>不改变证书选项配置</p><img src="'+u+'" alt="image-20220927154528494" style="zoom:100%;"><p>不给证书加密，按键输入两次回车</p><img src="'+f+`" alt="image-20220927154618352" style="zoom:100%;"><p>解压刚刚生成的zip包</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 解压文件</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">unzip</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> elasticsearch-ssl-http.zip</span></span></code></pre></div><p>将解压后的证书文件移动到config/certs目录中</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 移动文件</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">mv</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> elasticsearch/http.p12</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> kibana/elasticsearch-ca.pem</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> config/certs</span></span></code></pre></div></li><li><p>修改住配置文件：config/elasticsearch.yml</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置 ES 集群名称</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">cluster.name:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> es-cluster</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置集群中当前节点名称</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">node.name:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> es-node-1</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置数据，日志文件路径</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">path.data:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> /opt/module/elasticsearch-8.1.0/data</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">path.logs:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> /opt/module/elasticsearch-8.1.0/log</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置网络访问节点</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">network.host:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> linux1</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置网络访问端口</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">http.port:</span><span style="--shiki-light:#F76D47;--shiki-dark:#F78C6C;"> 9200</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 初始节点</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">discovery.seed_hosts:</span><span style="--shiki-light:#90A4AE;--shiki-dark:#BABED8;"> [</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;">linux1</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#90A4AE;--shiki-dark:#BABED8;">]</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 安全认证</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">xpack.security.enabled:</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;"> true</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">xpack.security.enrollment.enabled:</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;"> true</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">xpack.security.http.ssl:</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;"> enabled:</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;"> true</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;"> keystore.path:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> /opt/module/elasticsearch-8.1.0/config/certs/http.p12</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;"> truststore.path:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> /opt/module/elasticsearch-8.1.0/config/certs/http.p12</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">xpack.security.transport.ssl:</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;"> enabled:</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;"> true</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;"> verification_mode:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> certificate</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;"> keystore.path:</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">/opt/module/elasticsearch-8.1.0/config/certs/elastic-certificates.p12</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;"> truststore.path:</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">/opt/module/elasticsearch-8.1.0/config/certs/elastic-certificates.p12</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 此处需注意，es-node-1 为上面配置的节点名称</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">cluster.initial_master_nodes:</span><span style="--shiki-light:#90A4AE;--shiki-dark:#BABED8;"> [</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;">es-node-1</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;">&quot;</span><span style="--shiki-light:#90A4AE;--shiki-dark:#BABED8;">]</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">http.host:</span><span style="--shiki-light:#90A4AE;--shiki-dark:#BABED8;"> [_local_, </span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;">_site_]</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">ingest.geoip.downloader.enabled:</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;"> false</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">xpack.security.http.ssl.client_authentication:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> none</span></span></code></pre></div></li><li><p>启动ES软件</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 启动ES软件</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">bin/elasticsearch</span></span></code></pre></div></li></ol><p>第一次成功启动后，会显示密码，请记住，访问时需要。只有第一次才有！</p><img src="`+F+'" alt="image-20220927162802262" style="zoom:100%;">',13)),e(l,{color:"red"},{default:n(()=>[...s[0]||(s[0]=[t("上面图形内容因为涉及到多节点集群配置以及kibana配置，所以极其重要！！！",-1)])]),_:1}),e(l,{color:"red"},{default:n(()=>[...s[1]||(s[1]=[t("如果没有出现上面图片，出现下面图片也可以按照指示方式进行配置。",-1)])]),_:1}),s[7]||(s[7]=i("img",{src:b,alt:"image-20220927163303119",style:{zoom:"100%"}},null,-1)),s[8]||(s[8]=i("p",null,[i("img",{src:A,alt:"image-20220927163357772"})],-1)),s[9]||(s[9]=i("p",null,"注意：9300端口为Elasticsearch集群间组件的通信端口，9200端口为浏览器访问的http协议RESTFUL端口。",-1)),i("ol",S,[s[5]||(s[5]=a('<li><p>访问服务器节点<a href="https://xn--ces6a589dplei80c:9200" target="_blank" rel="noreferrer">https://虚拟机地址:9200</a></p><p>因为配置了安全协议，所以使用https协议进行访问，但由于证书是自己生成的，并不可靠，所以会有安全提示</p><img src="'+_+'" alt="image-20220927163743685" style="zoom:100%;"><p>选择继续或在该页面直接敲thisisunsafe即可</p><img src="'+v+'" alt="image-20220927163905182" style="zoom:100%;"><p>输入账号，密码登陆即可</p><img src="'+x+`" alt="image-20220927163951266" style="zoom:100%;"></li><li><p>修改集群中的其他节点配置文件：config/elasticsearch.yml</p><p>linux2: 证书直接拷贝，其他步骤完全相同，配置文件中修改如下内容即可</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置节点名称</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">node.name:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> es-node-2</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置网络访问主机</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">network.host:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> linux2</span></span></code></pre></div><p>linux3:证书直接拷贝，其他步骤完全相同，配置文件中修改如下内容即可</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置节点名称</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">node.name:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> es-node-3</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置网络访问主机</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">network.host:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> linux3</span></span></code></pre></div></li>`,2)),i("li",null,[i("p",null,[s[3]||(s[3]=t("依次启动集群的三台服务器节点, ",-1)),e(l,{color:"red"},{default:n(()=>[...s[2]||(s[2]=[t("不要忘记切换用户后再启动",-1)])]),_:1})]),s[4]||(s[4]=a(`<p>Linux1、linux2、linux3:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 后台启动服务</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">bin/elasticsearch</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> -d</span></span></code></pre></div>`,2))])]),s[10]||(s[10]=a('<h2 id="问题解决" tabindex="-1">问题解决 <a class="header-anchor" href="#问题解决" aria-label="Permalink to &quot;问题解决&quot;">​</a></h2><ul><li><p>Elasticsearch 是使用 java 开发的，8.1 版本的 ES 需要 JDK17 及以上版本。默认安装包 中带有 JDK 环境，如果系统配置 ES_JAVA_HOME 环境变量，那么会采用系统配置的 JDK。如果没有配置该环境变量，ES 会使用自带捆绑的 JDK。虽然自带的 JDK 是 ES 软件推荐的 Java 版本，但一般建议使用系统配置的 JDK。</p></li><li><p>Windows 环境中出现下面的错误信息，是因为开启了 SSL 认证：</p><img src="'+w+`" alt="image-20220927164758235" style="zoom:100%;"><p>修改 config/elasticsearch.yml 文件，将 enabled 的值修改为 false</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># Enable encryption for HTTP API client connections, such as Kibana, Logstash,</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">and</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> Agents</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">xpack.security.http.ssl:</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;"> enabled:</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;"> false</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;"> keystore.path:</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> certs/http.p12</span></span></code></pre></div></li><li><p>启动成功后，如果访问 localhost:9200 地址后，弹出登录窗口</p><p>第一次启动时，因为开启了密码验证模式，在启动窗口中会显示输入账号和密码。如果 没有注意到或没有找到账号密码，可以设置免密登录：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># Enable security features</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">xpack.security.enabled:</span><span style="--shiki-light:#39ADB5;--shiki-dark:#89DDFF;"> false</span></span></code></pre></div></li><li><p>双击启动窗口闪退，通过路径访问追踪错误，如果是“空间不足”，请修改config/jvm.options 配置文件</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置 JVM 初始内存为 1G。此值可以设置与-Xmx 相同，以避免每次垃圾回收完成后 JVM 重新分配</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">内存</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># Xms represents the initial size of total heap space</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 设置 JVM 最大可用内存为 1G</span></span>
<span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># Xmx represents the maximum size of total heap space</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">-Xms4g</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">-Xmx4g</span></span></code></pre></div></li><li><p>启动后，如果密码忘记了，怎么办？可以采用指令重置密码</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes material-theme-lighter material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-dark:#676E95;--shiki-dark-font-style:italic;"># 使用 es 用户，执行指令，重置 elastic 用户密码</span></span>
<span class="line"><span style="--shiki-light:#E2931D;--shiki-dark:#FFCB6B;">bin/elasticsearch-reset-password</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> -u</span><span style="--shiki-light:#91B859;--shiki-dark:#C3E88D;"> elastic</span></span></code></pre></div><img src="`+T+'" alt="image-20220927165222266" style="zoom:100%;"><p>如果只启动单一节点，此操作可能会失败，至少启动 2 个节点，测试成功</p></li></ul>',2))])}const j=p(z,[["render",P]]);export{R as __pageData,j as default};
